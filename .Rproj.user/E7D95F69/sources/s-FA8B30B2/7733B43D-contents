---
title: "Month of Birth and ADHD Persistence"
author: "Gosling CJ, Pinabiaux C, Caparos S, Delorme R & Cortese S"
date: "24/05/2020"
output: word_document
  
---

```{r setup, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo=TRUE)
library(knitr)
library(rmdformats)
```

# Forword

We would like to thank you warmly for your collaboration with our research team. 

This document details how to carry out the data analysis described in Gosling, Pinabiaux, Caparos, Delorme & Cortese (2020) <doi: >. 

As you will see, we will explain you:

  + how to install R and R studio
  + how to format your dataset
  + how to run the R script which will automatically perform all the required analyses 
  + how to share the results of the analyses with us
  
If you have any question, you can ask them directly to corentin.gosling@parisnanterre.fr. We can also schedule a visioconference to assist you in performing the analysis. All the process (from downloading R to obtaining results) usually takes no more than one hour.

# 1. Installing R and R studio (~ 15mn)

In order to install R studio, you will first need to install the basic version of R. R studio will provide a graphic interface, which will make it easier for you to perform the full analysis.

## Download basic R
In order to download basic R, go to: 
https://cran.r-project.org/ and select the version of R which is appropriate for your system (Windows / Linux / Mac OS X). Then install it. Once the basic version of R is installed, you can download R studio.


## Download R Studio 
In order to download R studio, go to: https://rstudio.com/products/rstudio/download/#download and select the version of R which is appropriate for your system. Once R studio is downloaded and installed on your computer, you can move on to the next step.

# 2. Formatting your dataset (~30mn)

In order to run the analyses, you will need to label your columns and values as described below. This operation should be done using the software which was used to compile the data (typically Excel, Open Office, or another spreadsheet software). The examples below are given for Excel users but they could be applied to any other software.

## Raw dataset
Open your dataset with the spreadsheet software you use. For instance:

![](/Users/coren/Desktop/Article 8 - Stabilité TDAH/Submit BMJ Open/IMG_raw_dataset ADHD.png)

## Select appropriate columns

Only 11 columns will be required for the analysis. Here is the list:

1.	A column containing the participant identifiers
2.	A column containing the age of participants at baseline
3.	A column containing the age of participants at follow up
4.	A column containing the follow up duration
5.	A column containing the month of birth of the participants *(If the birthdate of the participant is stored under a format like this (e.g., “07-11-1993” or "07/11/1993"), you can let your variable in this format but you have to inform us, so we can adapt the R code*
6.	A column containing the diagnosis status at follow up (confirmed or not confirmed)
7.	A column containing the subtype / presentation at baseline (hyperactive/inattentive/combined)
8.	A column containing the diagnosis procedure at baseline
9.	A column containing the diagnosis procedure at follow up
10.	A column containing the psychiatric comorbidities of the participants
11. A column containing the full-scale IQ score of the participants


## Rename columns 

In bold, the name that should be given to the corresponding column

+ Participants identifier = **ID**
+ Age at baseline = **agebaseline**
+ Age at Follow up = **agefollowup**
+ Follow up duration = **followupduration**
+ Month of birth = **month**
+ Diagnosis status at follow up = **diagconfirmed**
+ Subtype/presentation at baseline = **presentation**
+ Diagnosis procedure at baseline (Classification used, type of procedure (e.g., questionnaires, semi-structured clinical interview), and name of the tool used) = **diagbaseline**
+ Diagnosis procedure at follow up (Classification used, type of procedure (e.g., questionnaires, semi-structured clinical interview), and name of the tool used) = **diagfollowup**
+ Psychiatric comorbidities (e.g., Autism Spectrum Disorder) = **psychcomorbidity**
+ Full-scale IQ score = **iq**


## Recode values

We propose two solutions for recoding the values. 

+ In the first one, we propose to run a script on R that will allow us to determine how you have coded your dataset and then recode all the values automatically. If you choose this solution, refer to the point **Automatic Recoding** below

+ In the second one, we propose you to recode these values yourself. To help you, we have provided details on how to do this. If you choose this solution, please refer to the point **Manual Recoding** below. 

**+ Automatic Recoding**

In order to recode your dataset automatically, we need to determine how you have coded the values. To do this, please refer directly to point 3 of this document. 

**+ Manual Recoding**

In bold, the name that should be given to the corresponding values

+ Participants identifier = **no constraint** *You can identify your participants as you wish*
+ Age at baseline = **Age in years.** *For example, if a child was 8 years and 2 months at baseline, his* **"agebaseline"** *value should be: 8 + 2/12 =* **8.17**
+ Age at Follow up = **Age in years.** *For example, if a child was 11 years and 4 months at follow up, his* **"agefollowup"** *value should be: 11 + 4/12 =* **11.33**
+ Follow up duration = **Folluw up in years.** *For example, if a child has a follow up duration of 5 years and 8 months, his* **followupduration** *value should be: 5 + 8/12 =* **5.67**
+ Month of birth = **Standard months names.** *For example, january, february, march, etc... do not write the first letter in upper case (write january, not January)*
+ ADHD diagnosis status at follow up = **confirmed or notconfirmed.** *if the diagnosis is confirmed at follow up, the* **"diagconfirmed"** *value should be* **confirmed** /  *if the diagnosis is not confirmed at follow up (i.e., participants do not longer meet ADHD criteria), the* **"diagconfirmed"** *value should be* **notconfirmed**
+ Presentation = **Name of the subtype/presentation** *Should be either **hyperactive**, **inattentive** or **combined**. Again, do not write the first letter in upper case*
+ Diagnosis procedure at baseline (Classification used, type of procedure (e.g., questionnaires, semi-structured clinical interview), and name of the tool used) = **Name of the classification_type of procedure_name of tool.** *For example, if a child was diagnosed using the DSM-5 criteria and the ADHDRS questionnaire, his* **"diagbaseline"** *value should be* **DSM5_questionnaire_ADHDRS**. 
+ Diagnosis procedure at follow up (Classification used, type of procedure (e.g., questionnaires, semi-structured clinical interview), and name of the tool used) = **Name of the classification_type of procedure_name of tool.** *For example, if a child was diagnosed using the DSM-5 criteria and the ADHDRS questionnaire, his* **"diagfollowup"** *value should be* **DSM5_questionnaire_ADHDRS**.
  + Note that it is very important to use a consistent scoring in "diagbaseline" and "diagfollowup": analyses will compare these two columns to determine whether the same diagnosis procedure has been applied at baseline and follow up. The slightest difference in scoring between these two columns will therefore be interpreted as a difference in the diagnosis procedure used.
 + Psychiatric comorbidities (e.g., Autism Spectrum Disorder) = **none** or no constraint. *If a participant has no known psychiatric comorbidity, his* **"psychcomorbidity"** *value should be* **none**. *Otherwise, name the psychiatric comorbidity (no constraint on the label, but be careful to use consistent labelling across participants: you can identify Autism Spectrum Disorder as Autism Spectrum Disorder, ASD, Autism, etc… but you should use the same label for all participants with Autism).*
 + Full scale IQ = **score of the participants**. In the column, simply indicates the standardized score of the participants at the psychometric scale. 
 
**Important: if a missing value appears in your dataset (e.g., the diagnosis at follow up has not been collected for one participant), complete all information you have on this participant, but let the cell for his diagnosis status at follow up empty. Do not fill it with some impossible numbers (e.g., -999999)). **<br>
**If you did not have any information for a particular column (e.g., no participant included in your study have completed an IQ test), write the name of the column but let all the cells of this column empty to indicate that these values are missing. ** <br>
**The formatted dataset below provided you an example.**

**Formatted dataset** *Once you have finished these modifications, your dataset should look like this one.*<br>
*In this dataset, some participants have missing values in the month of birth, diagnosis status at follow up and psychiatric comorbidities, and the IQ has not been collected*

![](/Users/coren/Desktop/Article 8 - Stabilité TDAH/Submit BMJ Open/IMG_clean_dataset ADHD.png)

# 3. Load the dataset in R and recode values or perform data analysis (~15mn)

The R file script will help you load your dataset and either recode values or perform the data analysis. To run the script, follow the instructions described below:

+ Open R Studio
+ Load the script (the file entitled "Script_Performing_Analysis_YourName_MoB_ADHD.Rmd" sent you via email). 
To load the script:
  + Click on **File** (top left of R studio panel)
  + Then, click on **Open file..** 
  + an explorator window should open, you can locate and open the script.
+ Once the script is loaded, run each part of the script sequentially (starting from Part 1) by clicking on the green arrow at the top right of each greybox

![](/Users/coren/Documents/RunChunkADHD1.png)

A. Start by running the "Part 1. install packages required to the data analysis" to install the required packages

B. Once packages have been installed, you will have to load your dataset. Several options are available in the script, depending on the file format.
  
**Note that running the code to load your file will open an explorator window. However, this window sometimes opens behind all the open pages on your computer. To see this window, reduce R studio and all your open pages until you see it. **

Run either :
  + "Part 2.1.A." if your dataset is stored in .txt format
  or
  + "Part 2.1.B." or "Part 2.1.C." if your dataset is stored in .csv format (choose the appropriate separator)
  or
  + "Part 2.1.D." if your dataset is stored in .xls/xlsx format

  
C. View your dataset by running "Part 2.2 - Vizualise your dataset" to ensure that the dataset has been correctly loaded and that no issue has occured. **Note that running this code will open a new tab in R studio named "Data_ADHD". Once you have checked your data, you can come back to the script by clicking on the initial tab named "Script_Performing_Analysis_YourName_MoB_ADHD.Rmd"**

D.1 **If you have not recoded the dataset manually**, run the "Part 3 - Automating recoding of the data" of the script. Once you have run the "Part 3", ignore the following point D.2 of this document and jump to the point 4. 


D.2 **If you have correctly recoded the dataset manually**, the last step is to perform data analysis by running "Part 4 - Data analysis (your dataset has been correctly formatted)" of the script. Once you have run the Part 4, you can export the results by following indications in the point 4 of this document. 
  
  
# 4. Export results

Once you have run the script and the calculations are finished (you will know that the analyses are completed when the red stop flag in the top right of the R console disappears), the last result should be the location where the file has been generated. This message is under the form :

"[1] "C:/Users/your-name/Desktop/ADHD_StudyX_res.RData"

Last, send us this file at corentin.gosling@parisnanterre.fr. This output did not include any individual data, only summaries.<br>The results will be analyzed as soon as possible. When we will have finished to analyze your results, we will get back to you with the main conclusions that can be drawn from your study.

Thank you very much for your help! 

Dr Corentin J. Gosling,
Dr Charlotte Pinabiaux,
Dr Serge Caparos,
Prof Richard Delorme &
Prof Samuele Cortese
